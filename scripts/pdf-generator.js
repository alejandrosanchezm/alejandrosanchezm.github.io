class PDFGenerator{constructor(){this.init()}init(){}async generatePDF(){document.getElementById("loadingIndicator");try{if(this.showLoading(!0),void 0!==window.jsPDF)await this.generatePDFViaLibrary();else{if(!this.canUseBrowserPrint())throw Error("No PDF generation method available");await this.generatePDFViaPrint()}window.cvApp&&window.cvApp.showSuccess("PDF generado correctamente")}catch(n){window.cvApp&&window.cvApp.showError("Error al generar el PDF")}finally{this.showLoading(!1)}}canUseBrowserPrint(){return window.print&&"function"==typeof window.print}async generatePDFViaPrint(){const n=this.createPrintableContent(),i=window.open("","_blank");i.document.write(n),i.document.close(),await this.waitForImages(i.document),i.focus(),i.print(),setTimeout(()=>{i.close()},1e3)}createPrintableContent(){const n=window.languageManager?window.languageManager.getTranslatedCVData():window.cvApp?window.cvApp.cvData:null;if(!n)throw Error("No CV data available");const i=window.languageManager?window.languageManager.getCurrentLanguage():"es",e=n=>window.languageManager?window.languageManager.getTranslation(n):n;return`\n<!DOCTYPE html>\n<html lang="${i}">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${n.personalInfo.name} - ${n.personalInfo.title}</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            font-size: 11px;\n            line-height: 1.4;\n            color: #333;\n            background: white;\n            padding: 20px;\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 20px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid #2563eb;\n        }\n        \n        .name {\n            font-size: 24px;\n            font-weight: bold;\n            color: #1f2937;\n            margin-bottom: 5px;\n        }\n        \n        .title {\n            font-size: 16px;\n            color: #2563eb;\n            font-weight: 600;\n            margin-bottom: 10px;\n        }\n        \n        .contact-info {\n            font-size: 10px;\n            color: #6b7280;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section-title {\n            font-size: 14px;\n            font-weight: bold;\n            color: #1f2937;\n            margin-bottom: 10px;\n            padding-bottom: 3px;\n            border-bottom: 1px solid #e5e7eb;\n        }\n        \n        .experience-item,\n        .education-item {\n            margin-bottom: 15px;\n            page-break-inside: avoid;\n        }\n        \n        .item-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            margin-bottom: 5px;\n        }\n        \n        .item-title {\n            font-weight: bold;\n            font-size: 12px;\n            color: #1f2937;\n        }\n        \n        .item-company {\n            font-weight: 600;\n            color: #2563eb;\n            font-size: 11px;\n        }\n        \n        .item-duration {\n            font-size: 9px;\n            color: #6b7280;\n            text-align: right;\n        }\n        \n        .item-description {\n            margin-top: 5px;\n            font-size: 10px;\n            line-height: 1.3;\n            color: #4b5563;\n        }\n        \n        .skills-grid {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 15px;\n        }\n        \n        .skill-category {\n            margin-bottom: 10px;\n        }\n        \n        .skill-category-title {\n            font-weight: bold;\n            font-size: 11px;\n            color: #1f2937;\n            margin-bottom: 5px;\n        }\n        \n        .skill-list {\n            font-size: 9px;\n            color: #4b5563;\n            line-height: 1.3;\n        }\n        \n        .technologies {\n            margin-top: 5px;\n            font-size: 9px;\n            color: #6b7280;\n        }\n        \n        .tech-item {\n            display: inline;\n            margin-right: 8px;\n        }\n        \n        .tech-item:after {\n            content: "•";\n            margin-left: 8px;\n            color: #d1d5db;\n        }\n        \n        .tech-item:last-child:after {\n            content: "";\n        }\n        \n        .summary {\n            font-size: 10px;\n            line-height: 1.4;\n            color: #4b5563;\n            text-align: justify;\n            margin-bottom: 15px;\n        }\n        \n        @media print {\n            body { margin: 0; padding: 15px; }\n            .section { page-break-inside: avoid; }\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <div class="name">${n.personalInfo.name}</div>\n        <div class="title">${n.personalInfo.title}</div>\n        <div class="contact-info">\n            ${n.personalInfo.email} | ${n.personalInfo.phone} | ${n.personalInfo.location}\n            <br>\n            ${n.personalInfo.linkedin}\n        </div>\n    </div>\n    \n    <div class="section">\n        <div class="section-title">${e("about").toUpperCase()}</div>\n        <div class="summary">${n.summary}</div>\n    </div>\n    \n    <div class="section">\n        <div class="section-title">${e("experienceTitle").toUpperCase()}</div>\n        ${n.experience.map(n=>`\n            <div class="experience-item">\n                <div class="item-header">\n                    <div>\n                        <div class="item-title">${n.position}</div>\n                        <div class="item-company">${n.company}</div>\n                        ${n.sector?`<div style="font-size: 9px; color: #6b7280; margin-top: 2px;">${n.sector}</div>`:""}\n                    </div>\n                    <div class="item-duration">\n                        ${n.duration}<br>\n                        ${n.location}\n                        ${n.type?`<br><span style="font-size: 8px; color: #6b7280;">${n.type}</span>`:""}\n                    </div>\n                </div>\n                <div class="item-description">${n.description}</div>\n                ${n.careerProgression&&n.careerProgression.length>0?`\n                    <div style="margin-top: 8px; padding-left: 12px; border-left: 2px solid #e5e7eb;">\n                        <div style="font-size: 10px; font-weight: bold; color: #1f2937; margin-bottom: 4px;">\n                            ${"es"===i?"Progresión Profesional:":"Career Progression:"}\n                        </div>\n                        ${n.careerProgression.map(n=>`\n                            <div style="margin-bottom: 6px;">\n                                <div style="font-size: 10px; font-weight: 600; color: #2563eb;">\n                                    ${n.role} (${n.period})\n                                </div>\n                                <div style="font-size: 9px; color: #4b5563; line-height: 1.3;">\n                                    ${n.responsibilities}\n                                </div>\n                            </div>\n                        `).join("")}\n                    </div>\n                `:""}\n                ${n.keyTasks&&n.keyTasks.length>0?`\n                    <div style="margin-top: 6px;">\n                        <div style="font-size: 9px; font-weight: bold; color: #1f2937;">\n                            ${"es"===i?"Tareas Clave:":"Key Tasks:"}\n                        </div>\n                        <div style="font-size: 9px; color: #4b5563;">\n                            ${n.keyTasks.join(" • ")}\n                        </div>\n                    </div>\n                `:""}\n                ${n.technologies&&n.technologies.length>0?`\n                    <div class="technologies">\n                        <strong>${"es"===i?"Tecnologías":"Technologies"}:</strong> \n                        ${n.technologies.map(n=>`<span class="tech-item">${n}</span>`).join("")}\n                    </div>\n                `:""}\n            </div>\n        `).join("")}\n    </div>\n    \n    <div class="section">\n        <div class="section-title">${e("educationTitle").toUpperCase()}</div>\n        ${n.education.map(n=>`\n            <div class="education-item">\n                <div class="item-header">\n                    <div>\n                        <div class="item-title">${n.degree}</div>\n                        <div class="item-company">${n.institution}</div>\n                        ${n.note?`<div style="font-size: 9px; color: #f59e0b; font-weight: 600;">${n.note}</div>`:""}\n                    </div>\n                    <div class="item-duration">\n                        ${n.duration}<br>\n                        ${n.location}\n                    </div>\n                </div>\n            </div>\n        `).join("")}\n    </div>\n    \n    <div class="section">\n        <div class="section-title">${e("skillsTitle").toUpperCase()}</div>\n        <div class="skills-grid">\n            <div class="skill-category">\n                <div class="skill-category-title">${e("backendAPIs")}</div>\n                <div class="skill-list">${n.skills.backend?n.skills.backend.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n            <div class="skill-category">\n                <div class="skill-category-title">${e("frontendUI")}</div>\n                <div class="skill-list">${n.skills.frontend?n.skills.frontend.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n            <div class="skill-category">\n                <div class="skill-category-title">${e("databases")}</div>\n                <div class="skill-list">${n.skills.databases?n.skills.databases.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n            <div class="skill-category">\n                <div class="skill-category-title">${e("devopsTools")}</div>\n                <div class="skill-list">${n.skills.infrastructure?n.skills.infrastructure.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n            <div class="skill-category">\n                <div class="skill-category-title">${e("dataScience")}</div>\n                <div class="skill-list">${n.skills.dataScience?n.skills.dataScience.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n            <div class="skill-category">\n                <div class="skill-category-title">${e("mobile")}</div>\n                <div class="skill-list">${n.skills.mobile?n.skills.mobile.map(n=>n.name||n).join(", "):""}</div>\n            </div>\n        </div>\n    </div>\n    \n    ${n.projects&&n.projects.length>0?`\n    <div class="section">\n        <div class="section-title">${e("projectsTitle").toUpperCase()}</div>\n        ${n.projects.map(n=>`\n            <div class="experience-item">\n                <div class="item-header">\n                    <div>\n                        <div class="item-title">${n.title}</div>\n                        <div class="item-company">${n.company}</div>\n                        ${n.type?`<div style="font-size: 9px; color: #f59e0b; font-weight: 600;">${n.type}</div>`:""}\n                    </div>\n                    <div class="item-duration">${n.duration}</div>\n                </div>\n                <div class="item-description">${n.description}</div>\n                ${n.technologies&&n.technologies.length>0?`\n                    <div class="technologies">\n                        <strong>${"es"===i?"Tecnologías":"Technologies"}:</strong> \n                        ${n.technologies.map(n=>`<span class="tech-item">${n}</span>`).join("")}\n                    </div>\n                `:""}\n            </div>\n        `).join("")}\n    </div>\n    `:""}\n    \n    ${n.certifications&&n.certifications.length>0?`\n    <div class="section">\n        <div class="section-title">${e("certificationsTitle").toUpperCase()}</div>\n        ${n.certifications.map(n=>`\n            <div class="experience-item">\n                <div class="item-header">\n                    <div>\n                        <div class="item-title">${n.title}</div>\n                        <div class="item-company">${n.issuer}</div>\n                    </div>\n                    <div class="item-duration">${n.date}</div>\n                </div>\n                ${n.description?`<div class="item-description">${n.description}</div>`:""}\n            </div>\n        `).join("")}\n    </div>\n    `:""}\n    \n    ${n.languages&&n.languages.length>0?`\n    <div class="section">\n        <div class="section-title">${e("languagesTitle").toUpperCase()}</div>\n        <div class="skill-list">\n            ${n.languages.map(n=>`${n.language}: ${n.level}`).join(" | ")}\n        </div>\n    </div>\n    `:""}\n</body>\n</html>`}async waitForImages(n){const i=n.querySelectorAll("img"),e=Array.from(i).map(n=>new Promise(i=>{n.complete?i():(n.onload=i,n.onerror=i,setTimeout(i,3e3))}));return await Promise.all(e),new Promise(n=>setTimeout(n,500))}async generatePDFViaLibrary(){try{if(void 0===window.jsPDF)throw Error("jsPDF library not loaded");const{jsPDF:n}=window.jsPDF,i=new n({orientation:"portrait",unit:"mm",format:"a4"}),e=window.languageManager?window.languageManager.getTranslatedCVData():window.CV_DATA,t=window.languageManager?window.languageManager.getCurrentLanguage():"es";await this.generatePDFContent(i,e,t);const o=`CV_${e.personalInfo.name.replace(/\s+/g,"_")}_${t.toUpperCase()}.pdf`;return i.save(o),!0}catch(n){throw Error("Error generando PDF: "+n.message)}}async generatePDFContent(n,i,e){n.setFont("helvetica");let t=20;const o=20,s=n.internal.pageSize.width-40,d=(i,e,t,o,s=10,d="normal")=>{n.setFontSize(s),n.setFont("helvetica",d);const a=n.splitTextToSize(i,o);return n.text(a,e,t),t+.35*a.length*s},a=i=>{t+i>280&&(n.addPage(),t=20)};n.setFontSize(20),n.setFont("helvetica","bold"),n.text(i.personalInfo.name,o,t),t+=10,n.setFontSize(14),n.setFont("helvetica","normal"),n.text(i.personalInfo.title,o,t),t+=15,n.setFontSize(10),[i.personalInfo.email,i.personalInfo.phone,i.personalInfo.location,i.personalInfo.linkedin,i.personalInfo.github].filter(Boolean).forEach(i=>{n.text(i,o,t),t+=5}),t+=10,a(30);const l=window.languageManager?window.languageManager.getTranslation("about").toUpperCase():"PERFIL PROFESIONAL";n.setFontSize(12),n.setFont("helvetica","bold"),n.text(l,o,t),t+=8,t=d(i.summary,o,t,s,10),t+=10,t=await this.addExperienceSection(n,i,t,o,s,a,d),t=await this.addEducationSection(n,i,t,o,s,a,d),i.projects&&i.projects.length>0&&(t=await this.addProjectsSection(n,i,t,o,s,a,d)),i.certifications&&i.certifications.length>0&&(t=await this.addCertificationsSection(n,i,t,o,s,a,d))}async addExperienceSection(n,i,e,t,o,s,d){s(40);const a=window.languageManager?window.languageManager.getTranslation("experience").toUpperCase():"EXPERIENCIA PROFESIONAL";return n.setFontSize(12),n.setFont("helvetica","bold"),n.text(a,t,e),e+=8,i.experience.forEach(i=>{if(s(25),n.setFontSize(11),n.setFont("helvetica","bold"),n.text(`${i.position} - ${i.company}`,t,e),e+=6,n.setFontSize(9),n.setFont("helvetica","italic"),n.text(`${i.period} | ${i.location}`,t,e),e+=6,i.description&&(e=d(i.description,t,e,o,9),e+=3),i.careerProgression&&i.careerProgression.length>0&&i.careerProgression.forEach(i=>{n.setFontSize(9),n.setFont("helvetica","bold"),n.text(`• ${i.role} (${i.period})`,t+5,e),e+=4,i.responsibilities&&i.responsibilities.length>0&&i.responsibilities.forEach(n=>{e=d("  - "+n,t+10,e,o-10,8),e+=1}),e+=2}),i.keyTasks&&i.keyTasks.length>0){const s=window.languageManager?window.languageManager.getTranslation("keyTasks"):"Tareas clave";n.setFontSize(9),n.setFont("helvetica","bold"),n.text(s+":",t+5,e),e+=4,i.keyTasks.forEach(n=>{e=d("• "+n,t+10,e,o-10,8),e+=1})}if(i.technologies&&i.technologies.length>0){const s=window.languageManager?window.languageManager.getTranslation("technologies"):"Tecnologías";n.setFontSize(9),n.setFont("helvetica","bold"),n.text(s+": ",t+5,e),n.setFont("helvetica","normal");const a=i.technologies.join(", ");e=d(a,t+25,e,o-25,8)}e+=8}),e}async addEducationSection(n,i,e,t,o,s,d){s(30);const a=window.languageManager?window.languageManager.getTranslation("education").toUpperCase():"EDUCACIÓN";return n.setFontSize(12),n.setFont("helvetica","bold"),n.text(a,t,e),e+=8,i.education.forEach(i=>{s(15),n.setFontSize(11),n.setFont("helvetica","bold"),n.text(i.degree,t,e),e+=6,n.setFontSize(9),n.setFont("helvetica","italic"),n.text(`${i.institution} | ${i.period}`,t,e),e+=6,i.description&&(e=d(i.description,t,e,o,9)),e+=8}),e}async addProjectsSection(n,i,e,t,o,s,d){s(30);const a=window.languageManager?window.languageManager.getTranslation("projects").toUpperCase():"PROYECTOS";return n.setFontSize(12),n.setFont("helvetica","bold"),n.text(a,t,e),e+=8,i.projects.forEach(i=>{if(s(15),n.setFontSize(11),n.setFont("helvetica","bold"),n.text(i.name,t,e),e+=6,i.type&&(n.setFontSize(9),n.setFont("helvetica","italic"),n.text(i.type,t,e),e+=4),i.description&&(e=d(i.description,t,e,o,9),e+=3),i.technologies&&i.technologies.length>0){const s=window.languageManager?window.languageManager.getTranslation("technologies"):"Tecnologías";n.setFontSize(9),n.setFont("helvetica","bold"),n.text(s+": ",t,e),n.setFont("helvetica","normal");const a=i.technologies.join(", ");e=d(a,t+25,e,o-25,8)}e+=8}),e}async addCertificationsSection(n,i,e,t,o,s,d){s(30);const a=window.languageManager?window.languageManager.getTranslation("certifications").toUpperCase():"CERTIFICACIONES";return n.setFontSize(12),n.setFont("helvetica","bold"),n.text(a,t,e),e+=8,i.certifications.forEach(i=>{s(10),n.setFontSize(10),n.setFont("helvetica","bold"),n.text("• "+i.name,t,e),e+=5,i.issuer&&(n.setFontSize(9),n.setFont("helvetica","italic"),n.text("  "+i.issuer,t+5,e),e+=4),i.date&&(n.setFontSize(8),n.setFont("helvetica","normal"),n.text("  "+i.date,t+5,e),e+=4),e+=2}),e}showLoading(n){const i=document.getElementById("loadingIndicator");i&&i.classList.toggle("hidden",!n)}}document.addEventListener("DOMContentLoaded",()=>{window.pdfGenerator=new PDFGenerator}),"undefined"!=typeof module&&module.exports&&(module.exports=PDFGenerator);